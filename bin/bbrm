#!/usr/bin/env raku
use v6;

use File::Directory::Bubble;

my %*SUB-MAIN-OPTS=:named-anywhere,;
sub MAIN(
    Bool :h(:$help),
    Bool :n(:$dry) = False,    
    Bool :u(:$up) = False,
    *@FILES,
    ) {

    ($help) && do {
	my $cmd=qq{less $*PROGRAM-NAME};
	shell($cmd);
	exit;
    }

    my @down = @FILES.map({ |$_.IO.&bbDown }).unique(with => {$^a.Str eq $^b.Str});
    my @all = ($up) ?? ([|@down,|@FILES.map({ |$_.IO.&(&bbUpEmpty.assuming(*,@down)) })].unique(with => {$^a.Str eq $^b.Str})) !! (@down);

    ($dry) && do {
	("Would remove:", |@all>>.Str).map(*.say);
	exit;
    }

    
}

